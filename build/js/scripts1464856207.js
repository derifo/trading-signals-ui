"use strict";angular.module("app",["ngAnimate","ngMessages","ngResource","ngTouch","ngRoute","smart-table","ui.router","smart-table","countUpModule","angular-loading-bar","app.common.services","app.common.directives","app.states.layout","app.states.charts","app.states.signals","app.states.grids","app.core.dashboard","app.core.signals","app.core.trades","app.core.security"]).config(["$httpProvider","$stateProvider","$urlRouterProvider",function(t,a,n){t.defaults.useXDomain=!0,t.defaults.withCredentials=!0,delete t.defaults.headers.common["X-Requested-With"],t.defaults.headers.common={},t.defaults.headers.post={"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},t.defaults.headers.put={},t.defaults.headers.patch={},t.defaults.transformRequest=function(t){return void 0===t?t:$.param(t)},n.otherwise("/")}]).run(["$rootScope","$http","$state","themeService",function(t,a,n,s){a.defaults.transformResponse.unshift(function(t,a,s){return 401==s&&"app.security.login"!=n.current.name&&n.go("app.security.login"),t}),t.$on("$stateChangeSuccess",function(){"app.security.login"!=n.current.name&&a.get(sConfig.api+"api/traders/is_logged")}),a.appendTransform=function(t){return t=angular.isArray(t)?t:[t],t.concat(a.defaults.transformResponse)},s.initializeTheme()}]),angular.module("app.common.directives",[]),angular.module("app.common.filters",[]),angular.module("app.common.services",["ngResource"]),angular.module("app.states.charts",[]),angular.module("app.states.grids",[]),angular.module("app.states.layout",["ui.router"]).config(["$stateProvider",function(t){t.state("app",{url:"/","abstract":!0,views:{"navbar@":{templateUrl:"app/common/states/layout/navbar/navbar.tpl.html",controller:"app.states.layout.navbarCtrl"},"sidebar@":{templateUrl:"app/common/states/layout/sidebar/sidebar.tpl.html",controller:"app.states.layout.sidebarCtrl"}}})}]).run(["$rootScope",function(t){t.image=function(t){return"/images/"+t}}]),angular.module("app.states.signals",[]),angular.module("app.core.dashboard",["ui.router"]).config(["$stateProvider",function(t){t.state("app.dashboard",{url:"",data:{signalsList:{limit:6}},views:{"content@":{templateUrl:"/app/core/dashboard/dashboard.tpl.html",controller:"app.core.dashboardCtrl"},"tiles@app.dashboard":{templateUrl:"/app/common/states/charts/tiles/tiles.tpl.html",controller:"app.charts.tiles"},"signalsList@app.dashboard":{templateUrl:"/app/common/states/signals/list/list.tpl.html",controller:"app.signals.list"},"signalInfo@app.dashboard":{templateUrl:"/app/common/states/signals/signal/signal.tpl.html",controller:"app.signals.signal"}}})}]),angular.module("app.core.signals",["ui.router"]).config(["$stateProvider",function(t){t.state("app.signals",{url:"signals","abstract":!0}),t.state("app.signals.live",{url:"/live",data:{signalsList:{limit:10}},views:{"content@":{templateUrl:"/app/core/signals/live/live.tpl.html",controller:"app.core.signals.liveCtrl"},"signalsList@app.signals.live":{templateUrl:"/app/common/states/signals/list/list.tpl.html",controller:"app.signals.list"}}}),t.state("app.signals.history",{url:"/history",views:{"content@":{templateUrl:"/app/core/signals/history/history.tpl.html",controller:"app.core.signals.historyCtrl"}}})}]),angular.module("app.core.security",["ui.router"]).config(["$stateProvider",function(t){t.state("app.security",{url:"auth/","abstract":!0}),t.state("app.security.login",{url:"login",views:{"content@":{templateUrl:"/app/core/security/login/login.tpl.html",controller:"app.core.security.loginCtrl"},"navbar@":{templateUrl:"app/common/states/layout/navbar/navbar.tpl.html",controller:"app.states.layout.navbarCtrl"}}})}]),angular.module("app.core.trades",["ui.router"]).config(["$stateProvider",function(t){t.state("app.trades",{url:"trades","abstract":!0}),t.state("app.trades.open",{url:"/open",views:{"content@":{templateUrl:"/app/core/trades/open/open.tpl.html",controller:"app.core.trades.openCtrl"},"grid@app.trades.open":{templateUrl:"/app/common/states/grids/open-trades/open-trades.tpl.html",controller:"app.grids.openTrades"}}}),t.state("app.trades.history",{url:"/history",views:{"content@":{templateUrl:"/app/core/trades/history/history.tpl.html",controller:"app.core.trades.historyCtrl"},"grid@app.trades.history":{templateUrl:"/app/common/states/grids/trades-history/trades-history.tpl.html",controller:"app.grids.tradesHistory"}}})}]),angular.module("app.common.directives").directive("candleStick",["$timeout",function(t){return{restrict:"E",scope:{csData:"=",options:"="},link:function(t,a){function n(t){if(t.length){r||(r=!0,s=new google.visualization.AreaChart(a[0])),t=t.slice(0,24);var n={height:314,width:$(".chart-container-in").width(),legend:"none",areaOpacity:.18,axisTitlesPosition:"out",hAxis:{title:"",textStyle:{color:"#fff",fontName:"Proxima Nova",fontSize:11,bold:!0,italic:!1},textPosition:"none"},vAxis:{textPosition:"in",textStyle:{color:"#fff",fontName:"Proxima Nova",fontSize:11,bold:!0,italic:!1},baselineColor:"#16b4fc",gridlines:{color:"#1ba0fc",count:5}},lineWidth:2,colors:["#fff"],curveType:"function",pointSize:5,pointShapeType:"circle",pointFillColor:"#f00",backgroundColor:{fill:"#008ffb",strokeWidth:0},chartArea:{left:0,top:0,width:"100%",height:"100%"},fontSize:11,fontName:"Proxima Nova",tooltip:{trigger:"selection",isHtml:!0}},e=google.visualization.arrayToDataTable(t,!0);s.draw(e,n)}}var s,e=!1,r=!1;$(window).resize(function(){n(t.csData),setTimeout(function(){},1e3)}),google.charts.load("current",{packages:["corechart"]}),google.charts.setOnLoadCallback(function(){e=!0;var a=setInterval(function(){t.csData&&(n(t.csData),clearInterval(a))},100)}),t.$watch("csData",function(){e&&t.csData&&n(t.csData)})}}}]),angular.module("app.common.directives").directive("countdown",["$interval",function(t){return{restrict:"A",scope:{endTime:"@"},link:function(a,n){function s(t){var a=Date.parse(t)-Date.parse(new Date),n=Math.floor(a/1e3%60),s=Math.floor(a/1e3/60%60),e=Math.floor(a/36e5);return{total:a,hours:e>9?e:"0"+e,minutes:s>9?s:"0"+s,seconds:n>9?n:"0"+n}}function e(a){function e(){var t=s(a);n.text(t.hours+":"+t.minutes+":"+t.seconds),t.total<=0&&clearInterval(r)}e();var r=t(e,1e3)}e(new Date(Date.parse(a.endTime)))}}}]),angular.module("app.common.directives").directive("score",function(){return{restrict:"A",scope:{score:"@"},link:function(t,a){for(var n=t.score/20,s=1;5>=s;s+=1)n>=s?a.append($("<span></span>",{"class":"fa fa-star"})):n+.5>=s?a.append($("<span></span>",{"class":"fa fa-star-half-o"})):a.append($("<span></span>",{"class":"fa fa-star-o"}))}}}),angular.module("app.common.directives").directive("scrollPane",function(){return{restrict:"A",scope:{options:"@"},link:function(t,a){var n={autoReinitialise:!0,autoReinitialiseDelay:100};n=$.extend(n,t.options||{}),a.jScrollPane(n)}}}),angular.module("app.common.services").factory("merchantsSignalsAPI",["$resource",function(t){return t(sConfig.api+"api/traders/merchants/signals/:id",{},{query:{method:"GET",isArray:!0},save:{method:"POST",params:{id:"@id"}}})}]),angular.module("app.common.services").factory("signalsAPI",["$resource","$http",function(t,a){return t(sConfig.api+"api/traders/signals/:id",{},{query:{method:"GET",isArray:!0},buy:{method:"POST",url:sConfig.api+"api/traders/buy"},save:{method:"POST",params:{id:"@id"}}})}]),angular.module("app.common.services").factory("tradersAPI",["$resource","$http",function(t,a){return t(sConfig.api+"api/traders/traders",{},{query:{method:"GET",isArray:!0},getStatistics:{method:"GET",url:sConfig.api+"api/traders/traders/stats"},save:{method:"POST",params:{id:"@id"}},login:{method:"POST",url:sConfig.api+"api/traders/login"},logout:{method:"POST",url:sConfig.api+"api/traders/logout"}})}]),angular.module("app.common.services").factory("tradesAPI",["$resource","$http",function(t,a){return t(sConfig.api+"api/traders/trades/:id",{},{query:{method:"GET",isArray:!0},save:{method:"POST",params:{id:"@id"}}})}]),angular.module("app.common.services").service("assetFeedService",["$timeout",function(t){var a=io("http://52.48.242.152:8080");a.emit("feed-all");var n={};a.on("feed",function(t,a,n){a=JSON.parse(a),e(t,a,n)});var s=function(t,a){n[t]=n[t]||[],n[t].push(a)},e=function(t,a,s){n[t]&&n[t].length&&n[t].forEach(function(n){n(t,a,s)})};return{subscribe:function(t){var e;return{setAsset:function(r){if(e)for(var i in n[e]){var o=n[e][i];o==t&&delete n[e][i]}s(r,t),a.emit("requestFeed",r),e=r}}}}}]),angular.module("app.common.services").service("themeService",function(){return{initializeTheme:function(){setTimeout(function(){function t(){$(".box-typical-dashboard").each(function(){var t=$(this),a=t.find(".box-typical-header"),n=t.find(".box-typical-body");n.height(t.outerHeight()-a.outerHeight())})}function a(){var t=$(".section-header"),a=0;t.size()&&(a=parseInt(t.height())+parseInt(t.css("padding-bottom"))),$(".box-typical-full-height").css("min-height",$(window).height()-parseInt($(".page-content").css("padding-top"))-parseInt($(".page-content").css("padding-bottom"))-a-parseInt($(".box-typical-full-height").css("margin-bottom"))-2),$(".box-typical-full-height>.tbl, .box-typical-full-height>.box-typical-center").height(parseInt($(".box-typical-full-height").css("min-height")))}function n(){$(".chat-dialog-area").height($(window).height()-parseInt($(".page-content").css("padding-top"))-parseInt($(".page-content").css("padding-bottom"))-parseInt($(".chat-container").css("margin-bottom"))-2-$(".chat-area-header").outerHeight()-$(".chat-area-bottom").outerHeight()),$(".chat-list-in").height($(window).height()-parseInt($(".page-content").css("padding-top"))-parseInt($(".page-content").css("padding-bottom"))-parseInt($(".chat-container").css("margin-bottom"))-2-$(".chat-area-header").outerHeight()).css("min-height",parseInt($(".chat-dialog-area").css("min-height"))+$(".chat-area-bottom").outerHeight())}function s(){$(".box-typical-full-height-with-header").each(function(){var t=$(this),a=t.find(".box-typical-header"),n=t.find(".box-typical-body");n.height($(window).height()-parseInt($(".page-content").css("padding-top"))-parseInt($(".page-content").css("padding-bottom"))-parseInt(t.css("margin-bottom"))-2-a.outerHeight())})}function e(){$(".steps-icon-progress").each(function(){var t=$(this),a=t.find("ul"),n=0,s=(t.find("li:first-child").width()-t.find("li:first-child .caption").width())/2,e=(t.find("li:last-child").width()-t.find("li:last-child .caption").width())/2;n=s,s>e&&(n=e),a.css({marginLeft:-n,marginRight:-n})})}if(!("ontouchstart"in document.documentElement)){document.documentElement.className+=" no-touch";var r={autoReinitialise:!0,autoReinitialiseDelay:100};$(".box-typical-body").jScrollPane(r),$(".scrollable-block").jScrollPane(r)}$(".site-header .site-header-search").each(function(){var t=$(this),a=t.find(".overlay");a.click(function(){t.removeClass("closed")}),t.clickoutside(function(){t.hasClass("closed")||t.addClass("closed")})}),$(".site-header-collapsed .dropdown").each(function(){var t=$(this),a=t.find(".dropdown-toggle");a.click(function(){t.hasClass("mobile-opened")?t.removeClass("mobile-opened"):t.addClass("mobile-opened")})}),$(".dropdown-more").each(function(){var t=$(this),a=t.find(".dropdown-more-caption"),n="opened";a.click(function(){t.hasClass(n)?t.removeClass(n):t.addClass(n)})}),$(".hamburger").click(function(){$("body").hasClass("menu-left-opened")?($(this).removeClass("is-active"),$("body").removeClass("menu-left-opened"),$("html").css("overflow","auto")):($(this).addClass("is-active"),$("body").addClass("menu-left-opened"),$("html").css("overflow","hidden"))}),$(".mobile-menu-left-overlay").click(function(){$(".hamburger").removeClass("is-active"),$("body").removeClass("menu-left-opened"),$("html").css("overflow","auto")}),$(".site-header .burger-right").click(function(){$("body").hasClass("menu-right-opened")?($("body").removeClass("menu-right-opened"),$("html").css("overflow","auto")):($(".hamburger").removeClass("is-active"),$("body").removeClass("menu-left-opened"),$("body").addClass("menu-right-opened"),$("html").css("overflow","hidden"))}),$(".mobile-menu-right-overlay").click(function(){$("body").removeClass("menu-right-opened"),$("html").css("overflow","auto")}),$(".help-dropdown").each(function(){var t,a=$(this),n=a.find(">button");a.find(".help-dropdown-popup");n.click(function(){a.hasClass("opened")?(a.removeClass("opened"),t.destroy()):(a.addClass("opened"),$(".help-dropdown-popup-cont, .help-dropdown-popup-side").matchHeight(),"ontouchstart"in document.documentElement||setTimeout(function(){t=a.find(".jscroll").jScrollPane(r).data().jsp},0))}),$("html").click(function(n){$(n.target).closest(".help-dropdown-popup").length||$(n.target).closest(".help-dropdown>button").length||$(n.target).is(".help-dropdown-popup")||$(n.target).is(".help-dropdown>button")||a.hasClass("opened")&&(a.removeClass("opened"),t.destroy())})}),$(".side-menu-list li.with-sub").each(function(){var t=$(this),a=t.find(">span"),n=t.find("ul");a.click(function(){t.hasClass("opened")?(t.removeClass("opened"),n.slideUp()):($(".side-menu-list li.with-sub").not(this).removeClass("opened").find("ul").slideUp(),t.addClass("opened"),n.slideDown())})}),t(),$(window).resize(function(){t()}),$(".box-typical-dashboard").each(function(){var t=$(this),a=t.find(".action-btn-collapse");a.click(function(){t.hasClass("box-typical-collapsed")?t.removeClass("box-typical-collapsed"):t.addClass("box-typical-collapsed")})}),$(".box-typical-dashboard").each(function(){var a=$(this),n=a.find(".action-btn-expand"),s="box-typical-full-screen";n.click(function(){a.hasClass(s)?(a.removeClass(s),$("html").css("overflow","auto")):(a.addClass(s),$("html").css("overflow","hidden")),t()})}),a(),$(window).resize(function(){a()}),n(),$(window).resize(function(){n()}),$(".page-center").matchHeight({target:$("html")}),$(window).resize(function(){setTimeout(function(){$(".page-center").matchHeight({remove:!0}),$(".page-center").matchHeight({target:$("html")})},100)}),s(),$(window).resize(function(){s()}),$(".dd-handle").hover(function(){$(this).prev("button").addClass("hover"),$(this).prev("button").prev("button").addClass("hover")},function(){$(this).prev("button").removeClass("hover"),$(this).prev("button").prev("button").removeClass("hover")}),setTimeout(function(){"ontouchstart"in document.documentElement||$(".side-menu-addl").jScrollPane(r)},1e3),$(".widget-chart-combo-content-in, .widget-chart-combo-side").matchHeight(),$('.dropdown-menu-messages a[data-toggle="tab"]').click(function(t){t.stopPropagation(),t.preventDefault(),$(this).tab("show"),"ontouchstart"in document.documentElement||(i=$(".dropdown-notification.messages .tab-pane.active").jScrollPane(r).data().jsp)});var i,o;$(".dropdown-notification.messages").on("show.bs.dropdown",function(){"ontouchstart"in document.documentElement||(i=$(".dropdown-notification.messages .tab-pane.active").jScrollPane(r).data().jsp)}),$(".dropdown-notification.messages").on("hide.bs.dropdown",function(){"ontouchstart"in document.documentElement||i.destroy()}),$(".dropdown-notification.notif").on("show.bs.dropdown",function(){"ontouchstart"in document.documentElement||(o=$(".dropdown-notification.notif .dropdown-menu-notif-list").jScrollPane(r).data().jsp)}),$(".dropdown-notification.notif").on("hide.bs.dropdown",function(){"ontouchstart"in document.documentElement||o.destroy()}),e(),$(window).resize(function(){e()}),$(".control-panel-toggle").on("click",function(){var t=$(this);t.hasClass("open")?(t.removeClass("open"),$(".control-panel").removeClass("open")):(t.addClass("open"),$(".control-panel").addClass("open"))}),$(".control-item-header .icon-toggle, .control-item-header .text").on("click",function(){var t=$(this).closest("li").find(".control-item-content");t.hasClass("open")?t.removeClass("open"):($(".control-item-content.open").removeClass("open"),t.addClass("open"))})},200)}}}),angular.module("app.common.directives").directive("compareTo",function(){return{require:"ngModel",scope:{otherModelValue:"=compareTo"},link:function(t,a,n,s){s.$validators.compareTo=function(a){return a==t.otherModelValue},t.$watch("otherModelValue",function(){document.activeElement==a[0]&&s.$validate()})}}}),angular.module("app.common.services").constant("userToken",{}),angular.module("app.states.charts").controller("app.charts.membersTrades",["$scope","tradersAPI",function(t,a){}]),angular.module("app.states.charts").controller("app.charts.statistics",["$scope","tradersAPI",function(t,a){a.getStatistics().$promise.then(function(t){}),t.percent=65,t.options={easing:"easeOutElastic",delay:3e3,barColor:"#69c",trackColor:"#ace",scaleColor:!1,lineWidth:16,trackWidth:16,lineCap:"butt"},$(".epie").easyPieChart({})}]),angular.module("app.states.charts").controller("app.charts.tiles",["$scope","tradersAPI","$rootScope",function(t,a,n){var s=function(){a.getStatistics().$promise.then(function(a){a.win_rate=parseFloat(100/a.total_trades*a.wins).toFixed(2),t.stats=a})};s(),n.$on("traderSignalBought",s)}]),angular.module("app.states.grids").controller("app.grids.openTrades",["$scope","tradesAPI","assetFeed",function(t,a,n){t.rowCollection=a.query({tradeStatus:1}),t.getters={firstName:function(t){return t.firstName.length}},t.rates={},t.getRate=function(a){return t.rates[a]=t.rates[a]||0,n.subscribe(a,function(n,s){t.rates[a]=s}),t.rates[a]}}]),angular.module("app.states.grids").controller("app.grids.tradesHistory",["$scope","tradesAPI","assetFeed",function(t,a,n){t.rowCollection=a.query({tradeStatus:[2,3]}),t.rates={},t.getRate=function(a){return t.rates[a]=t.rates[a]||0,n.subscribe(a,function(n,s){t.rates[a]=s}),t.rates[a]}}]),angular.module("app.states.layout").controller("app.states.layout.navbarCtrl",["$scope","tradersAPI","$state",function(t,a,n){t.logout=function(){a.logout().$promise.then(function(){n.transitionTo("app.security.login")})}}]),angular.module("app.states.layout").controller("app.states.layout.sidebarCtrl",["$scope","$interval","$state",function(t,a,n){t.$state=n}]),angular.module("app.states.signals").controller("app.signals.list",["$scope","merchantsSignalsAPI","signalsAPI","$state","assetFeedService","$filter","$rootScope",function(t,a,n,s,e,r,i){t.buyOptions={amount:50},t.openIndex=0,t.signals=a.query(s.current.data.signalsList).$promise.then(function(a){t.signals=a,t.$emit("showSignal",a[0])}),t.signalClicked=function(a){t.$emit("showSignal",a)}}]),angular.module("app.states.signals").controller("app.signals.signal",["$scope","merchantsSignalsAPI","signalsAPI","$state","assetFeedService","$filter","$rootScope",function(t,a,n,s,e,r,i){var o=this;o.subscribeFeed=e.subscribe(function(a,n,s){var e=t.signal;t.$apply(function(){e.chartData=[],e.rateStatus=t.currentRate>s?"up":"down",e.currentRate=s,angular.forEach(n,function(t,a){a=a.replace(" ","T"),e.chartData.push([r("date")(Date.parse(a),"yyyy-MM-dd HH:mm:ss"),parseFloat(t.close)])}),t.signal=e})});var l=function(t){o.subscribeFeed.setAsset(t.signal.asset.socket_id)};i.$on("showSignal",function(a,s){t.signal=s,t.signal.chartData=[],l(t.signal),t.buySignal=function(a){t.buyOptions.buying=!0;var s={signal_id:a.signal.id,amount:t.buyOptions.amount};n.buy(s).$promise.then(function(a){1==a.status&&i.$emit("traderSignalBought"),t.buyOptions.buying=!1})}})}]),angular.module("app.core.dashboard").controller("app.core.dashboardCtrl",["$scope","tradersAPI","$timeout",function(t,a,n){}]),angular.module("app.core.signals").controller("app.core.signals.historyCtrl",["$scope","tradersAPI","$timeout",function(t,a,n){}]),angular.module("app.core.dashboard").controller("app.core.signals.liveCtrl",["$scope","tradersAPI","$timeout",function(t,a,n){}]),angular.module("app.core.security").controller("app.core.security.loginCtrl",["$scope","$timeout","tradersAPI","$state",function(t,a,n,s){t.formSubmitted=function(){var a={email:t.credentials.email,password:t.credentials.password};t.submitted=!0,n.login(a).$promise.then(function(a){a.error?t.error="Invalid email or password combination":s.transitionTo("app.dashboard")})}}]),angular.module("app.core.trades").controller("app.core.trades.historyCtrl",["$scope","tradersAPI","$timeout",function(t,a,n){}]),angular.module("app.core.dashboard").controller("app.core.trades.openCtrl",["$scope","tradersAPI","$timeout",function(t,a,n){}]);